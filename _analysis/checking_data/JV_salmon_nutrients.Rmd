---
title: "JV_salmon_farm"
author: "Juliette"
date: "5/28/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(tidyverse)
library(here)
library(countrycode)

prep <- "/home/shares/food-systems/Food_footprint/dataprep/"
final <- "/home/shares/food-systems/Food_footprint/final_data/" 
raw <- "/home/shares/food-systems/Food_footprint/_raw_data/" 

land_eez_rgns_tif <- raster("/home/shares/food-systems/Food_footprint/dataprep/spatial/land_eez_rgns.tif")
food_crs <- "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
rgn_info <- read_csv(here("_spatial/output/master_rgns.csv"))

```

Grab total salmon production data

```{r}

our_salmon_raster <- read_csv(file.path(prep, "salmon_farm/salmon_farm.csv")) %>% 
  raster::rasterFromXYZ(crs = food_crs)

combine_rasts <- stack(our_salmon_raster, land_eez_rgns_tif)
salmon_df <- as.data.frame(combine_rasts, xy=TRUE)   

our_salmon <- salmon_df %>% 
  rename(ID_0 = land_eez_rgns) %>%
  group_by(ID_0) %>% 
  dplyr::summarise(our_maped_production = sum(tonnes_production, na.rm = TRUE))


```


Nutrients

From Bouwman paper:
"Between 2000 and 2010, N excretion by marine aquaculture increased from 0.3 to 0.6 million tonnes of N and from 0.04 to 0.1 million tonnes of P per year."

Table 6 lists these values for trout:
39 kg DN/tonne
3 kg DP/tonne

We will use them to calculate total DN and DP and compare to what we have.

```{r}

nitrogen_spatial <- read_csv(file.path(prep, "salmon_nutrient_pollution/salmon_aquaculture_nitrogen_released_df.csv"))
nitrogen <- nitrogen_spatial %>% 
  dplyr::summarise(global_N = sum(DN_out))

phosphorous_spatial <- read_csv(file.path(prep, "salmon_nutrient_pollution/salmon_aquaculture_phosphorous_released_df.csv"))
phosphorous <- phosphorous_spatial %>% 
  dplyr::summarise(global_N = sum(DP_out))
  
tonnes_global <- our_salmon %>% 
  dplyr::summarise(tonnes = sum(our_maped_production)) %>% 
  mutate(N = tonnes*(39/1000),
         P = tonnes*(3/1000))
  
```

Paper values: no way this is accurate because of statement above
92,384.91 tonne N
7,106.531 tonne P
 
Our values
112,435.7 tonne N
9,378.549 tonne P










